context("Custom HR")


# This checks that burden estiamtes are positive


demog_data <- data.frame(age = seq(0,85,5),
           population = c(720,703,722,1080,1448,805,781,614,603,656,679,697,615,490,437,376,218,194),
           deaths = c(0.584494655662292,0.0487179487179487,0.175030303030303,0.598574821852732,0.837817508534398,0.328265175346615,0.494190059825127,0.445330915684497,0.832125853860484,1.36431440045898,1.70917939251552,2.77517253583437,5.15983432455395,4.34576600656056,5.5016835016835,12.4138572425017,12.9816772374912,27.2661691542289)
           )

hr_1.06 <- rep(1.062, nrow(demog_data))
hr_custom <- c(1,1,1,1,1,1,1.15962457176748,1.15886251864246,1.1575573067708,1.15473438857183,1.15116136563688,1.14716839451139,1.14275992592599,1.13772715329064,1.1318658761749,1.12487218837444,1.11310285674061,1.11310285674061)


expect_true(burden_le(demog_data,
          pm_concentration = 10,
          min_age_at_risk = 0,
          RR = 1.062)$difference[1,2] > 0)

expect_true(burden_le(demog_data,
          custom_hr = TRUE, hr = hr_1.06)$difference[1,2] > 0)

expect_true(burden_le(demog_data,
          custom_hr = TRUE, hr = hr_custom)$difference[1,2] > 0)

